<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Food Express</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .snap-x::-webkit-scrollbar { display: none; }
    .overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center;
      z-index: 50;
    }
  </style>
</head>
<body class="bg-white font-sans">

  <!-- Top Bar -->
  <div class="flex justify-between items-center px-4 pt-4">
    <div class="text-sm text-gray-700" id="location">📍 Detecting location...</div>
    <div class="text-2xl">🔔</div>
  </div>

  <!-- Search Bar -->
  <div class="flex items-center space-x-2 px-4 py-2">
    <div class="text-xl">🔍</div>
    <input type="text" placeholder="Search Food Express" class="flex-1 p-2 rounded-lg bg-gray-100" />
    <div class="text-xl">🎤</div>
  </div>

  <!-- Promo Banners -->
  <div class="overflow-x-auto px-4 snap-x snap-mandatory scroll-smooth">
    <div class="flex space-x-3 mt-2 w-max">
      <img src="https://i.postimg.cc/1tyQKPD9/promo.jpg" class="h-[180px] w-[320px] rounded-lg" />
      <img src="https://i.imgur.com/MH2a8rD.jpg" class="h-[180px] w-[320px] rounded-lg" />
      <img src="https://i.imgur.com/q8Aaw0m.jpg" class="h-[180px] w-[320px] rounded-lg" />
    </div>
  </div>

  <!-- Categories -->
  <div class="flex overflow-x-auto space-x-3 p-4">
    <div class="bg-orange-200 rounded-full px-4 py-2">🍔 Burger</div>
    <div class="bg-orange-200 rounded-full px-4 py-2">🍕 Pizza</div>
    <div class="bg-orange-200 rounded-full px-4 py-2">🥗 Salad</div>
    <div class="bg-orange-200 rounded-full px-4 py-2">🍣 Sushi</div>
    <div class="bg-orange-200 rounded-full px-4 py-2">🌮 Tacos</div>
  </div>

  <!-- Top Picks -->
  <div class="px-4">
    <h2 class="text-lg font-bold mb-2">Top picks</h2>
    <div class="flex overflow-x-auto space-x-4 pb-24">
      <div class="w-64 bg-white shadow rounded-xl p-3 flex-shrink-0">
        <img src="https://i.imgur.com/0y8Ftya.jpg" class="w-full h-32 object-cover rounded-lg" />
        <h3 class="mt-2 font-bold">Cheese Burger</h3>
        <p class="text-gray-500 text-sm">Burger Haven • 31 min • 4.8★</p>
        <p class="text-orange-600 font-bold mt-1">$8.99</p>
        <button onclick="addToCart('Cheese Burger', 8.99)" class="bg-orange-500 text-white rounded-full w-full py-1 mt-2">Add to Cart</button>
      </div>

      <div class="w-64 bg-white shadow rounded-xl p-3 flex-shrink-0">
        <img src="https://i.imgur.com/nQF2zWb.jpg" class="w-full h-32 object-cover rounded-lg" />
        <h3 class="mt-2 font-bold">BBQ Bacon Burger</h3>
        <p class="text-gray-500 text-sm">Burger Haven • 27 min • 4.6★</p>
        <p class="text-orange-600 font-bold mt-1">$9.49</p>
        <button onclick="addToCart('BBQ Bacon Burger', 9.49)" class="bg-orange-500 text-white rounded-full w-full py-1 mt-2">Add to Cart</button>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <div class="fixed bottom-0 left-0 right-0 bg-white shadow-t p-2 flex justify-around items-center border-t">
    <div class="text-center text-orange-500">🏠<br><span class="text-xs">Home</span></div>
    <div class="text-center">📦<br><span class="text-xs">Orders</span></div>
    <div class="text-center relative cursor-pointer" onclick="goToCart()">
      🛒
      <span class="absolute -top-1 -right-2 bg-red-500 text-white rounded-full text-xs px-1" id="cartCount">0</span>
      <br><span class="text-xs">Cart</span>
    </div>
    <div class="text-center cursor-pointer" onclick="openLoginPopup()">👤<br><span class="text-xs" id="accountLabel">Account</span></div>
  </div>

  <!-- Login/Signup Popup -->
  <div id="loginPopup" class="overlay">
    <div class="bg-white p-6 rounded-lg w-80">
      <h2 class="text-lg font-bold mb-4" id="popupTitle">Login</h2>
      <input type="text" id="nameField" placeholder="Name" class="border p-2 w-full mb-2 hidden" />
      <input type="email" id="emailField" placeholder="Email" class="border p-2 w-full mb-2" />
      <input type="password" id="passwordField" placeholder="Password" class="border p-2 w-full mb-1" />
      <p id="errorMsg" class="text-red-500 text-sm mb-3 hidden">Incorrect email or password</p>
      <button onclick="submitAuth()" class="bg-orange-500 text-white py-2 px-4 w-full rounded">Submit</button>
      <p class="text-center text-sm mt-3 cursor-pointer text-blue-500" onclick="toggleAuthMode()" id="toggleText">Create account</p>
      <p class="text-center text-sm mt-3 cursor-pointer text-gray-500" onclick="closeLoginPopup()">Cancel</p>
    </div>
  </div>

  <script>
    let authMode = "login"; 
    let currentUser = localStorage.getItem("loggedInUser");
    let cart = [];

    function openLoginPopup() {
      if (currentUser) {
        window.location.href = "account.html";
      } else {
        document.getElementById("loginPopup").style.display = "flex";
      }
    }
    function closeLoginPopup() { 
      document.getElementById("loginPopup").style.display = "none"; 
      document.getElementById("errorMsg").classList.add("hidden");
    }

    function toggleAuthMode() {
      authMode = authMode === "login" ? "signup" : "login";
      document.getElementById("popupTitle").innerText = authMode === "login" ? "Login" : "Signup";
      document.getElementById("toggleText").innerText = authMode === "login" ? "Create account" : "Already have an account?";
      document.getElementById("nameField").classList.toggle("hidden", authMode === "login");
      document.getElementById("errorMsg").classList.add("hidden");
    }

    function submitAuth() {
      const email = document.getElementById("emailField").value.trim();
      const password = document.getElementById("passwordField").value.trim();
      const errorMsg = document.getElementById("errorMsg");

      if (authMode === "signup") {
        const name = document.getElementById("nameField").value.trim();
        if (!name || !email || !password) {
          errorMsg.innerText = "All fields are required";
          errorMsg.classList.remove("hidden");
          return;
        }
        let users = JSON.parse(localStorage.getItem("users") || "[]");
        if (users.find(u => u.email === email)) {
          errorMsg.innerText = "Email already exists";
          errorMsg.classList.remove("hidden");
          return;
        }
        users.push({ name, email, password, cart: [] });
        localStorage.setItem("users", JSON.stringify(users));
        toggleAuthMode();
        errorMsg.classList.add("hidden");
      } else {
        let users = JSON.parse(localStorage.getItem("users") || "[]");
        let user = users.find(u => u.email === email && u.password === password);
        if (!user) {
          errorMsg.innerText = "Incorrect email or password";
          errorMsg.classList.remove("hidden");
          return;
        }
        localStorage.setItem("loggedInUser", email);
        currentUser = email;
        loadUserCart();
        closeLoginPopup();
        document.getElementById("accountLabel").innerText = user.name;
        window.location.href = "cart.html"; // Go to cart after login
      }
    }

    ["nameField", "emailField", "passwordField"].forEach(id => {
      document.getElementById(id).addEventListener("input", () => {
        document.getElementById("errorMsg").classList.add("hidden");
      });
    });

    function loadUserCart() {
      if (!currentUser) return;
      let users = JSON.parse(localStorage.getItem("users") || "[]");
      let user = users.find(u => u.email === currentUser);
      cart = user ? user.cart : [];
      updateCartCount();
    }
    function saveUserCart() {
      if (!currentUser) return;
      let users = JSON.parse(localStorage.getItem("users") || "[]");
      let idx = users.findIndex(u => u.email === currentUser);
      if (idx !== -1) {
        users[idx].cart = cart;
        localStorage.setItem("users", JSON.stringify(users));
      }
    }
    function addToCart(name, price) {
      cart.push({ name, price });
      updateCartCount();
      saveUserCart();
    }
    function updateCartCount() { 
      document.getElementById("cartCount").innerText = cart.length; 
    }
    function goToCart() { 
      if (!currentUser) {
        openLoginPopup();
      } else {
        window.location.href = "cart.html";
      }
    }

    window.onload = () => {
      currentUser = localStorage.getItem("loggedInUser");
      if (currentUser) {
        let users = JSON.parse(localStorage.getItem("users") || "[]");
        let user = users.find(u => u.email === currentUser);
        if (user) {
          document.getElementById("accountLabel").innerText = user.name;
          cart = user.cart || [];
          updateCartCount();
        }
      }
    };
  </script>
</body>
</html>
