<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Food Express - Account</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore.js"></script>
  <style>
    .active-tab { color: #f97316; }
    .cart-badge {
      position: absolute;
      top: -6px;
      right: -6px;
      background: #f97316;
      color: white;
      border-radius: 9999px;
      padding: 2px 6px;
      font-size: 12px;
      display: none;
    }
    .cart-badge.show { display: inline-block; }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-white p-4 shadow-md">
    <h1 class="text-xl font-bold">My Account</h1>
  </header>

  <!-- Profile Section -->
  <section class="bg-white p-6 mt-4 flex items-center space-x-4 shadow-md">
    <img src="https://i.pravatar.cc/100" alt="User" class="w-16 h-16 rounded-full border">
    <div>
      <h2 id="userName" class="text-lg font-semibold">Loading...</h2>
      <p id="userPhone" class="text-gray-600">Fetching...</p>
      <p id="userEmail" class="text-gray-600">Fetching...</p>
    </div>
  </section>

  <!-- Quick Links -->
  <section class="mt-6 flex-1">
    <div class="bg-white shadow-md rounded-lg mx-4">
      <ul class="divide-y divide-gray-200">
        <li class="p-4 hover:bg-gray-50 cursor-pointer">ğŸ“¦ My Orders</li>
        <li class="p-4 hover:bg-gray-50 cursor-pointer">ğŸ’³ Payments</li>
        <li class="p-4 hover:bg-gray-50 cursor-pointer">ğŸ  Addresses</li>
        <li class="p-4 hover:bg-gray-50 cursor-pointer">â“ Help & Support</li>
        <li id="logoutBtn" class="p-4 hover:bg-gray-50 cursor-pointer text-red-500">ğŸšª Logout</li>
      </ul>
    </div>
  </section>

  <!-- Bottom Navigation -->
<div class="fixed bottom-0 left-0 right-0 bg-white shadow-lg border-t rounded-t-2xl">
  <div id="bottomNav" class="flex justify-around items-center py-2">
    
    <!-- Home -->
    <div class="nav-item flex flex-col items-center cursor-pointer text-orange-500 transition-all duration-300 transform" data-tab="home">
      <span class="text-2xl">ğŸ </span>
      <span class="text-xs font-medium">Home</span>
    </div>
    
    <!-- Orders -->
    <div class="nav-item flex flex-col items-center cursor-pointer text-gray-500 transition-all duration-300 transform" data-tab="orders">
      <span class="text-2xl">ğŸ“¦</span>
      <span class="text-xs font-medium">Orders</span>
    </div>
    
    <!-- Cart -->
    <div class="nav-item flex flex-col items-center relative cursor-pointer text-gray-500 transition-all duration-300 transform" data-tab="cart">
      <span class="text-2xl">ğŸ›’</span>
      <span class="absolute -top-1 -right-2 bg-red-500 text-white rounded-full text-[10px] px-1" id="cartCount">0</span>
      <span class="text-xs font-medium">Cart</span>
    </div>
    
    <!-- Account -->
    <div class="nav-item flex flex-col items-center cursor-pointer text-gray-500 transition-all duration-300 transform" data-tab="account">
      <span class="text-2xl">ğŸ‘¤</span>
      <span class="text-xs font-medium" id="accountLabel">Account</span>
    </div>
    
  </div>
</div>

<script type="module">
  // Firebase config
  const firebaseConfig = {
   apiKey: "AIzaSyCAGirQsFfQNInhUc9yuMD-QElaDnmRbKE",
   authDomain: "foodexpress-9b0ff.firebaseapp.com",
   projectId: "foodexpress-9b0ff",
   storageBucket: "foodexpress-9b0ff.firebasestorage.app",
   messagingSenderId: "818281594225",
   appId: "1:818281594225:web:205774c2914ae2b9b08ad0"
  };

  // Init Firebase
  const app = firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // Load user info
  auth.onAuthStateChanged(async (user) => {
    if (user) {
      document.getElementById("userName").innerText = user.displayName || "User";
      document.getElementById("userEmail").innerText = user.email || "No Email";
      document.getElementById("userPhone").innerText = user.phoneNumber || "No Phone";

      // If you stored signup details in Firestore (users collection)
      const userDoc = await db.collection("users").doc(user.uid).get();
      if (userDoc.exists) {
        const data = userDoc.data();
        if (data.name) document.getElementById("userName").innerText = data.name;
        if (data.email) document.getElementById("userEmail").innerText = data.email;
        if (data.phone) document.getElementById("userPhone").innerText = data.phone;
      }
    } else {
      window.location.href = "login.html"; // Redirect if not logged in
    }
  });

  // Logout
  document.getElementById("logoutBtn").addEventListener("click", () => {
    auth.signOut().then(() => {
      window.location.href = "login.html";
    });
  });

  // Bottom Nav
  function setActiveTab(tabName) {
    document.querySelectorAll("#bottomNav .nav-item").forEach(item => {
      if (item.dataset.tab === tabName) {
        item.classList.remove("text-gray-500", "scale-100");
        item.classList.add("text-orange-500", "scale-110");
      } else {
        item.classList.remove("text-orange-500", "scale-110");
        item.classList.add("text-gray-500", "scale-100");
      }
    });
  }
  setActiveTab("account");

  document.querySelectorAll("#bottomNav .nav-item").forEach(item => {
    item.addEventListener("click", () => {
      const tab = item.dataset.tab;
      setActiveTab(tab);
      if (tab === "orders") window.location.href = "orders.html";
      if (tab === "home") window.location.href = "index.html";
      if (tab === "cart") window.location.href = "cart.html";
      if (tab === "account") window.location.href = "account.html";
    });
  });

  // Cart badge update
  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const cartCount = document.getElementById("cartCount");
  if (cart.length > 0) {
    cartCount.innerText = cart.length;
    cartCount.classList.remove("hidden");
  }
</script>

</body>
</html>
